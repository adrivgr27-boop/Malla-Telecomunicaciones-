<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malla Curricular - Ingeniería en Telecomunicaciones</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

        :root {
            --bg-color: #f4f7f9;
            --primary-color: #5b9bd5;
            --secondary-color: #e6f0fa;
            --text-color: #333;
            --card-bg: #fff;
            --completed-bg: #d4edda;
            --completed-border: #c3e6cb;
            --locked-bg: #f8d7da;
            --locked-border: #f5c6cb;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition-speed: 0.3s;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        p.subtitle {
            font-size: 1.2rem;
            color: #666;
        }

        .curriculum-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .semester {
            background-color: var(--secondary-color);
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .semester-title {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .semester-title .total-uc {
            font-size: 1rem;
            font-weight: 400;
            color: #666;
        }

        .course-card {
            background-color: var(--card-bg);
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all var(--transition-speed) ease;
            position: relative;
            cursor: pointer;
            user-select: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .course-card.completed {
            background-color: var(--completed-bg);
            border-color: var(--completed-border);
            color: #155724;
            transform: scale(1.02);
        }

        .course-card.locked {
            background-color: var(--locked-bg);
            border-color: var(--locked-border);
            color: #721c24;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .course-card .course-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 1.1rem;
        }

        .course-card .course-uc {
            font-size: 0.9rem;
            color: #666;
        }
        
        .course-card.completed .course-uc {
            color: #155724;
        }

        .course-card.locked .course-uc {
            color: #721c24;
        }

        .tooltip {
            position: absolute;
            top: 50%;
            left: 105%;
            transform: translateY(-50%);
            background-color: #333;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            font-size: 0.9rem;
            white-space: nowrap;
            visibility: hidden;
            opacity: 0;
            transition: opacity var(--transition-speed), visibility var(--transition-speed);
            z-index: 10;
        }

        .course-card.locked:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        .tooltip::before {
            content: '';
            position: absolute;
            left: -10px;
            top: 50%;
            transform: translateY(-50%);
            border-width: 5px;
            border-style: solid;
            border-color: transparent #333 transparent transparent;
        }

        .info-panel {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 2rem;
            box-shadow: var(--shadow);
        }

        .info-panel h2 {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .info-panel p {
            font-size: 1rem;
        }
        
        .disclaimer {
            text-align: center;
            color: #999;
            margin-top: 2rem;
            font-size: 0.8rem;
        }

    </style>
</head>
<body>

    <header>
        <h1>Malla Curricular Interactiva</h1>
        <p class="subtitle">Ingeniería en Telecomunicaciones</p>
    </header>

    <main>
        <div class="curriculum-grid" id="curriculum-grid"></div>

        <div class="info-panel">
            <h2>Resumen del Progreso</h2>
            <p><strong>Total de Unidades de Crédito Aprobadas:</strong> <span id="total-uc-approved">0</span></p>
            <p><strong>Porcentaje de Carrera Aprobado:</strong> <span id="progress-percentage">0</span>%</p>
        </div>
        
        <div class="disclaimer">
            <p>Para guardar tu progreso, simplemente recarga la página. Tu avance se guardará automáticamente en este navegador.</p>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const curriculumData = {
                'Primer Semestre': {
                    totalUc: 26,
                    courses: [
                        { name: 'Algebra y Trigonometría', uc: 5, id: 'algebra_trigonometria' },
                        { name: 'Cálculo Diferencial', uc: 6, id: 'calculo_diferencial' },
                        { name: 'Lógica', uc: 4, id: 'logica' },
                        { name: 'Competencia textual español', uc: 5, id: 'competencia_textual' },
                        { name: 'Introducción a las telecomunicaciones', uc: 3, id: 'intro_telecomunicaciones' },
                        { name: 'Identidad, Liderazgo y Compromiso I', uc: 3, id: 'identidad_liderazgo_1' }
                    ]
                },
                'Segundo Semestre': {
                    totalUc: 30,
                    courses: [
                        { name: 'Cálculo Integral', uc: 5, id: 'calculo_integral', req: ['calculo_diferencial'] },
                        { name: 'Algebra Lineal', uc: 6, id: 'algebra_lineal', req: ['calculo_diferencial', 'algebra_trigonometria'] },
                        { name: 'Contabilidad Financiera', uc: 5, id: 'contabilidad_financiera', reqUc: 15 },
                        { name: 'Física General', uc: 6, id: 'fisica_general', req: ['calculo_diferencial'] },
                        { name: 'Programación Estructurada', uc: 5, id: 'programacion_estructurada', req: ['logica'] },
                        { name: 'Identidad, Liderazgo y Compromiso II', uc: 3, id: 'identidad_liderazgo_2', req: ['identidad_liderazgo_1'] }
                    ]
                },
                'Tercer Semestre': {
                    totalUc: 30,
                    courses: [
                        { name: 'Ecuaciones Diferenciales Ordinarias', uc: 4, id: 'ecuaciones_diferenciales', req: ['calculo_integral', 'algebra_lineal'] },
                        { name: 'Cálculo Vectorial', uc: 5, id: 'calculo_vectorial', req: ['calculo_integral'] },
                        { name: 'Ingeniería Económica', uc: 4, id: 'ingenieria_economica', req: ['contabilidad_financiera'] },
                        { name: 'Circuitos Eléctricos', uc: 6, id: 'circuitos_electricos', req: ['ecuaciones_diferenciales'] },
                        { name: 'Laboratorio de Circuitos Eléctricos', uc: 3, id: 'lab_circuitos_electricos', req: ['circuitos_electricos'] },
                        { name: 'Programación Orientada a Objetos', uc: 5, id: 'programacion_orientada_objetos', req: ['programacion_estructurada'] },
                        { name: 'Innovación y Emprendimiento', uc: 3, id: 'innovacion_emprendimiento', req: ['identidad_liderazgo_1'] }
                    ]
                },
                'Cuarto Semestre': {
                    totalUc: 31,
                    courses: [
                        { name: 'Probabilidades', uc: 6, id: 'probabilidades', req: ['series_transformadas'] },
                        { name: 'Series y Transformadas', uc: 6, id: 'series_transformadas', req: ['calculo_vectorial', 'ecuaciones_diferenciales'] },
                        { name: 'Teoría de Ondas', uc: 5, id: 'teoria_ondas', req: ['calculo_vectorial', 'ecuaciones_diferenciales', 'fisica_general'] },
                        { name: 'Circuitos y Sistemas Electrónicos', uc: 6, id: 'circuitos_sistemas_electronicos', req: ['circuitos_electricos'] },
                        { name: 'Electrónica Digital', uc: 5, id: 'electronica_digital', req: ['circuitos_electricos'] },
                        { name: 'Ecología, Ambiente y Sustentabilidad', uc: 3, id: 'ecologia_ambiente_sustentabilidad', req: ['innovacion_emprendimiento'] }
                    ]
                },
                'Quinto Semestre': {
                    totalUc: 29,
                    courses: [
                        { name: 'Señales y Sistemas Continuos', uc: 7, id: 'senales_sistemas_continuos', req: ['series_transformadas', 'probabilidades'] },
                        { name: 'Variable Compleja', uc: 5, id: 'variable_compleja', req: ['probabilidades'] },
                        { name: 'Campos Electromagnéticos', uc: 6, id: 'campos_electromagneticos', req: ['teoria_ondas'] },
                        { name: 'Fundamentos de Redes de Datos', uc: 5, id: 'fundamentos_redes_datos', req: ['electronica_digital'] },
                        { name: 'Laboratorio de Electrónica Digital', uc: 3, id: 'lab_electronica_digital', req: ['electronica_digital', 'lab_circuitos_electricos'] },
                        { name: 'Laboratorio de Circuitos y Sistemas Electrónicos', uc: 3, id: 'lab_circuitos_sistemas_electronicos', req: ['circuitos_sistemas_electronicos', 'lab_circuitos_electricos'] },
                        { name: 'Curso Servicio Comunitario', uc: 0, id: 'curso_servicio_comunitario' }
                    ]
                },
                'Sexto Semestre': {
                    totalUc: 29,
                    courses: [
                        { name: 'Fundamentos de Comunicaciones', uc: 6, id: 'fundamentos_comunicaciones', req: ['senales_sistemas_continuos', 'variable_compleja'] },
                        { name: 'Cálculo Numérico para Telecomunicaciones', uc: 5, id: 'calculo_numerico', req: ['series_transformadas', 'variable_compleja'] },
                        { name: 'Radiaciones y Ondas Guiadas', uc: 5, id: 'radiaciones_ondas_guiadas', req: ['series_transformadas', 'variable_compleja', 'campos_electromagneticos'] },
                        { name: 'Enrutamiento Dinámico en Redes', uc: 5, id: 'enrutamiento_dinamico', req: ['fundamentos_redes_datos'] },
                        { name: 'Laboratorio de Redes de Datos', uc: 3, id: 'lab_redes_datos', req: ['fundamentos_redes_datos'] },
                        { name: 'Sistemas Embebidos', uc: 5, id: 'sistemas_embebidos', req: ['circuitos_sistemas_electronicos', 'electronica_digital', 'lab_electronica_digital'] },
                        { name: 'Servicio Comunitario', uc: 0, id: 'servicio_comunitario' }
                    ]
                },
                'Séptimo Semestre': {
                    totalUc: 30,
                    courses: [
                        { name: 'Comunicaciones Digitales', uc: 6, id: 'comunicaciones_digitales', req: ['fundamentos_comunicaciones'] },
                        { name: 'Señales y Sistemas Discretos', uc: 6, id: 'senales_sistemas_discretos', req: ['calculo_numerico'] },
                        { name: 'Antenas', uc: 5, id: 'antenas', req: ['radiaciones_ondas_guiadas'] },
                        { name: 'Ondas de Alta Frecuencia', uc: 5, id: 'ondas_alta_frecuencia', req: ['radiaciones_ondas_guiadas'] },
                        { name: 'Laboratorio de Enrutamiento Dinámico en Redes', uc: 3, id: 'lab_enrutamiento_dinamico', req: ['enrutamiento_dinamico', 'lab_redes_datos'] },
                        { name: 'Redes Convergentes', uc: 5, id: 'redes_convergentes', req: ['enrutamiento_dinamico'] }
                    ]
                },
                'Octavo Semestre': {
                    totalUc: 25,
                    courses: [
                        { name: 'Fundamentos de Comunicaciones Ópticas', uc: 4, id: 'comunicaciones_opticas', req: ['comunicaciones_digitales'] },
                        { name: 'Laboratorio de Comunicaciones', uc: 3, id: 'lab_comunicaciones', req: ['comunicaciones_digitales'] },
                        { name: 'Procesamiento de Señales', uc: 4, id: 'procesamiento_senales', req: ['senales_sistemas_discretos'] },
                        { name: 'Laboratorio de Gestión y Seguridad en Redes', uc: 4, id: 'lab_gestion_seguridad', req: ['redes_convergentes', 'lab_enrutamiento_dinamico'] },
                        { name: 'Ética Profesional', uc: 3, id: 'etica_profesional', reqUc: 180 },
                        { name: 'Seminario de Trabajo de Grado', uc: 2, id: 'seminario_trabajo_grado', reqUc: 204 },
                        { name: 'Radio Comunicaciones', uc: 5, id: 'radio_comunicaciones', req: ['antenas'] }
                    ]
                },
                'Noveno Semestre': {
                    totalUc: 21,
                    courses: [
                        { name: 'Redes Ópticas', uc: 4, id: 'redes_opticas', req: ['comunicaciones_opticas'] },
                        { name: 'Sistemas de Radiodifusión', uc: 5, id: 'sistemas_radiodifusion', reqUc: 205 },
                        { name: 'Sistemas Inalámbricos', uc: 4, id: 'sistemas_inalambricos', reqUc: 205 },
                        { name: 'Electiva Profesional', uc: 4, id: 'electiva_profesional_1', reqUc: 205 },
                        { name: 'Electiva Profesional', uc: 4, id: 'electiva_profesional_2', reqUc: 205 }
                    ]
                },
                'Requisitos Adicionales': {
                    totalUc: 20,
                    courses: [
                        { name: 'Pasantía', uc: 4, id: 'pasantia', reqUc: 205 },
                        { name: 'Trabajo de Grado', uc: 16, id: 'trabajo_grado' }
                    ]
                }
            };
            
            const totalCareerUc = 251; // Suma total de UC de la carrera
            let approvedCourses = JSON.parse(localStorage.getItem('approvedCourses')) || [];

            const grid = document.getElementById('curriculum-grid');
            const totalUcApprovedSpan = document.getElementById('total-uc-approved');
            const progressPercentageSpan = document.getElementById('progress-percentage');
            
            // Función para obtener el nombre de una materia por su ID
            const getCourseNameById = (id) => {
                for (const semester in curriculumData) {
                    const course = curriculumData[semester].courses.find(c => c.id === id);
                    if (course) return course.name;
                }
                return 'Requisito desconocido';
            };

            const updateProgress = () => {
                let totalUc = 0;
                approvedCourses.forEach(id => {
                    const course = getCourseDataById(id);
                    if (course) totalUc += course.uc;
                });
                totalUcApprovedSpan.textContent = totalUc;
                const percentage = ((totalUc / totalCareerUc) * 100).toFixed(2);
                progressPercentageSpan.textContent = percentage;
            };
            
            const getCourseDataById = (id) => {
                for (const semester in curriculumData) {
                    const course = curriculumData[semester].courses.find(c => c.id === id);
                    if (course) return course;
                }
                return null;
            };
            
            const isCourseApproved = (courseId) => {
                return approvedCourses.includes(courseId);
            };

            const checkRequirements = (course) => {
                let unlocked = true;
                const missingReqs = [];
                let ucApprovedTotal = 0;
                
                approvedCourses.forEach(id => {
                    const courseData = getCourseDataById(id);
                    if (courseData) ucApprovedTotal += courseData.uc;
                });

                if (course.req) {
                    for (const reqId of course.req) {
                        if (!isCourseApproved(reqId)) {
                            unlocked = false;
                            missingReqs.push(getCourseNameById(reqId));
                        }
                    }
                }
                
                if (course.reqUc && ucApprovedTotal < course.reqUc) {
                    unlocked = false;
                    missingReqs.push(`Total de UC: ${course.reqUc} UC (Tienes ${ucApprovedTotal})`);
                }
                
                return { unlocked, missingReqs };
            };

            const renderCurriculum = () => {
                grid.innerHTML = '';
                for (const semesterName in curriculumData) {
                    const semester = curriculumData[semesterName];
                    const semesterDiv = document.createElement('div');
                    semesterDiv.classList.add('semester');
                    
                    const semesterTitle = document.createElement('h2');
                    semesterTitle.classList.add('semester-title');
                    semesterTitle.innerHTML = `${semesterName} <span class="total-uc">${semester.totalUc} UC</span>`;
                    semesterDiv.appendChild(semesterTitle);

                    semester.courses.forEach(course => {
                        const courseCard = document.createElement('div');
                        courseCard.classList.add('course-card');
                        courseCard.dataset.id = course.id;

                        const { unlocked, missingReqs } = checkRequirements(course);
                        
                        if (isCourseApproved(course.id)) {
                            courseCard.classList.add('completed');
                        } else if (!unlocked) {
                            courseCard.classList.add('locked');
                            const tooltip = document.createElement('div');
                            tooltip.classList.add('tooltip');
                            tooltip.innerHTML = `Falta: <br> ${missingReqs.join('<br>')}`;
                            courseCard.appendChild(tooltip);
                        }
                        
                        courseCard.innerHTML += `<div class="course-name">${course.name}</div>`;
                        courseCard.innerHTML += `<div class="course-uc">${course.uc} UC</div>`;
                        
                        semesterDiv.appendChild(courseCard);
                    });
                    
                    grid.appendChild(semesterDiv);
                }
                updateProgress();
            };
            
            const handleCourseClick = (event) => {
                const card = event.target.closest('.course-card');
                if (!card) return;
                
                const courseId = card.dataset.id;
                
                if (card.classList.contains('locked')) {
                    // Do nothing if the card is locked
                    return;
                }
                
                if (isCourseApproved(courseId)) {
                    // Remove from approved list
                    approvedCourses = approvedCourses.filter(id => id !== courseId);
                } else {
                    // Add to approved list
                    approvedCourses.push(courseId);
                }
                
                localStorage.setItem('approvedCourses', JSON.stringify(approvedCourses));
                renderCurriculum(); // Re-render the entire grid
            };
            
            grid.addEventListener('click', handleCourseClick);
            
            // Initial render
            renderCurriculum();
        });
    </script>
</body>
</html>
